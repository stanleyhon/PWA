<html lang="en">
    <head>
        <title>Media Controls Tester</title>
        <meta charset="utf-8">
        <meta http-equiv="Content-Security-Policy"
              content="img-src self
                               https://raw.githubusercontent.com/LiaHiscock/PWA/main/MediaControls/App1/pink.png 
                               https://liahiscock.github.io/PWA/MediaControls/">
        <link rel="manifest" href="./manifest.webmanifest">
        <link rel="icon" href="pink.png">
    </head>

    <body>
        <h3 id="songTitle">Another Christmas Song</h3>
        <audio controls id="audio1">
            <source src="mixkit-hollidays-690.mp3" type="audio/mpeg">
        </audio>
        <br><br>

        <h3><a href="../App2/index.html">PWA #2</a></h3>
        <h3><a href="../App3/index.html">PWA #3</a></h3>

        <br><br><br>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/jfKfPfyJRdk"
        title="YouTube video player" frameborder="0"
        allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share">
        </iframe>
    </body>

    <script src="./app.js"></script>
    <script>
        var audioMetadata =
        {
            title: "A Christmas Song",
            artist: "Main PWA pink",
            album: "album",
            artwork: [
                {
                    src: "https://raw.githubusercontent.com/LiaHiscock/PWA/main/MediaControls/App1/pink.png",
                    sizes: "144x144",
                    type: "image/png",
                },
            ],
        };

        var audioSources = ['mixkit-a-very-happy-christmas-897.mp3', 'mixkit-hollidays-690.mp3'];
        var audioTitles = ['First Christmas Song', 'Another Christmas Song'];

        var audio = document.getElementById("audio1");
        audio.volume = 0.1;

        if ("mediaSession" in navigator) {
            navigator.mediaSession.metadata = new MediaMetadata(audioMetadata);
        }

        var index = 0;
        audio.addEventListener('ended', function onNext() {
            audio.pause();
            document.getElementById('songTitle').innerText = audioTitles[index % 2];
            audio.innerHTML = `<source src=${audioSources[index % 2]} type=\"audio/mpeg\">`;
            audio.load();
            audio.play();
            audioMetadata.title = audioTitles[index % 2];
            if ("mediaSession" in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata(audioMetadata);
            }
            index++;
        });
    </script>
</html>

<!-- Sources -->

<!-- 
    mixkit-a-very-happy-christmas-897.mp3: https://mixkit.co/free-stock-music/
    
    audio1.jpg: https://images.pexels.com/photos/717988/pexels-photo-717988.jpeg?cs=srgb&dl=christmas-tree-with-baubles-717988.jpg&fm=jpg
 -->